$(function(){var n=null,t;$("#loginModal").on("show.bs.modal",function(t){var i=$(t.relatedTarget);n=i.data("redirect")});$("#submitLogin").on("click",function(t){t.preventDefault();var i=$("#loginForm").serializeJSON();$.ajax({type:"post",url:"/api/users/login",data:JSON.stringify(i),contentType:"application/json"}).done(function(t){Cookies.set("token",t.token);Cookies.set("username",t.username);window.location=n==null?window.location:n}).fail(function(){$("#loginError").empty();var n=`<div class="alert alert-danger alert-dismissible" id="errorMessage">
                    <span class="fa fa-warning" aria-hidden="true"></span>
                    <span class="sr-only">Error:</span>
                    <a href = "#" class="close" data-dismiss="alert" aria-label="close">&times;</a>
                    Invalid username or password.
                </div>`;$("#loginError").append(n)})});$("#submitRegister").on("click",function(n){n.preventDefault();var i=$("#registerForm").serializeJSON();t(i)==!0&&$.ajax({type:"post",url:"/api/users",data:JSON.stringify(i),contentType:"application/json"}).done(function(n){Cookies.set("token",n.token);Cookies.set("username",n.username);window.location=window.location}).fail(function(n){n.responseText.split(",").forEach(function(n){n=="username.length"?$("#usernameLength").removeClass("d-none"):n=="username.duplicate"?$("#usernameExists").removeClass("d-none"):n=="password.length"&&$("#passwordLength").removeClass("d-none")})})});t=function(n){var t=!0;return(n.username.length<4||n.username.length>32)&&($("#usernameLength").removeClass("d-none"),t=!1),(n.password.length<4||n.password.length>32)&&($("#passwordLength").removeClass("d-none"),t=!1),n.password!=n.confirmPassword&&($("#confirmPasswordDiff").removeClass("d-none"),t=!1),t};$("#registerForm input[name=username]").on("focus",function(){$("#usernameLength").addClass("d-none");$("#usernameExists").addClass("d-none")});$("#registerForm input[name=password]").on("focus",function(){$("#passwordLength").addClass("d-none");$("#confirmPasswordDiff").addClass("d-none")});$("#registerForm input[name=confirmPassword]").on("focus",function(){$("#confirmPasswordDiff").addClass("d-none")})});